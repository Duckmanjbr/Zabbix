   zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 846977d1dfed4968bc5f8bdb363285bc
      name: 'Templates/Operating systems'
  host_groups:
    - uuid: f2481361f99448eea617b7b1d4765566
      name: 'Discovered hosts'
  templates:
    - uuid: b476ba9059114181b5d56147af545d94
      template: 'Unifi by SNMP'
      name: 'Unifi by SNMP'
      description: |
        This is a Unifi template. It requires an SNMP client.


        Notes on filesystem (FS) discovery:
          - The ext4/3/2 FS reserves space for privileged usage, typically set at 5% by default.
          - BTRFS allocates a default of 10% of the volume for its own needs.
          - To mitigate potential disasters, FS usage triggers are based on the maximum available space.
            - Utilization formula: 'pused = 100 * (used / used + available)'
          - The FS utilization chart, derived from graph prototypes, reflects FS reserved space as the difference between used and available space from the total volume.

        You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/387225-discussion-thread-for-official-zabbix-template-for-linux

        Generated by official Zabbix template tool "Templator"
     vendor:
        name: Unifi 
        version: 7.0.x
      groups:
        - name: 'Templates/Operating systems'
      items:
        - uuid: 9f94439d9d1b4542a4c646de569e21e1
          name: 'ICMP ping'
          type: SIMPLE
          key: icmpping
          description: |
            The host accessibility by ICMP ping.

            0 - ICMP ping fails;
            1 - ICMP ping successful.
          valuemap:
            name: 'Service state'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 4303d20155824960b9a638b21a785a7c
              expression: 'max(/Unifi by SNMP/icmpping,#3)=0'
              name: 'Linux: Unavailable by ICMP ping'
              priority: HIGH
              description: 'Last three attempts returned timeout. Please check device connectivity.'
              tags:
                - tag: scope
                  value: availability
        - uuid: 85b11b0f21364a5ca9abef4f43a95aa2
          name: 'ICMP loss'
          type: SIMPLE
          key: icmppingloss
          value_type: FLOAT
          units: '%'
          description: 'The percentage of lost packets.'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 7cb256fc1d184a28b345a7b68572d535
              expression: 'min(/Unifi by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Unifi by SNMP/icmppingloss,5m)<100'
              name: 'Linux: High ICMP ping loss'
              opdata: 'Loss: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'ICMP packets loss detected.'
              dependencies:
                - name: 'Linux: Unavailable by ICMP ping'
                  expression: 'max(/Unifi by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: c9072fd9632f47fabdb780dd4298c827
          name: 'ICMP response time'
          type: SIMPLE
          key: icmppingsec
          value_type: FLOAT
          units: s
          description: 'The ICMP ping response time (in seconds).'
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: cf01e5ff491746da8ead287b415fb3c6
              expression: 'avg(/Unifi by SNMP/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'Linux: High ICMP ping response time'
              opdata: 'Value: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'Average ICMP response time is too high.'
              dependencies:
                - name: 'Linux: High ICMP ping loss'
                  expression: 'min(/Unifi by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Unifi by SNMP/icmppingloss,5m)<100'
                - name: 'Linux: Unavailable by ICMP ping'
                  expression: 'max(/Unifi by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: e2192675297147d48f2f8e68915d13d9
          name: 'Linux: SNMP walk EtherLike-MIB interfaces'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.2.1.10.7.2.1.19,1.3.6.1.2.1.2.2.1.8,1.3.6.1.2.1.31.1.1.1.18,1.3.6.1.2.1.31.1.1.1.1,1.3.6.1.2.1.2.2.1.2]'
          key: net.if.duplex.walk
          history: '0'
          value_type: TEXT
          trends: '0'
          description: 'Discovering interfaces from IF-MIB and EtherLike-MIB. Interfaces with `up(1)` Operational Status are discovered.'
          tags:
            - tag: component
              value: raw
        - uuid: 5dc635c72a984c6d91f1019851d86330
          name: 'Linux: SNMP walk network interfaces'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.2.1.2.2.1.8,1.3.6.1.2.1.2.2.1.7,1.3.6.1.2.1.31.1.1.1.18,1.3.6.1.2.1.31.1.1.1.1,1.3.6.1.2.1.2.2.1.2,1.3.6.1.2.1.2.2.1.3,1.3.6.1.2.1.31.1.1.1.6,1.3.6.1.2.1.31.1.1.1.10,1.3.6.1.2.1.2.2.1.14,1.3.6.1.2.1.2.2.1.20,1.3.6.1.2.1.2.2.1.19,1.3.6.1.2.1.2.2.1.13,1.3.6.1.2.1.31.1.1.1.15]'
          key: net.if.walk
          history: '0'
          value_type: TEXT
          trends: '0'
          description: 'Discovering interfaces from IF-MIB.'
          tags:
            - tag: component
              value: raw
        - uuid: 2e10b57c2ccb45879de0874c53cbf02f
          name: 'SNMP traps (fallback)'
          type: SNMP_TRAP
          key: snmptrap.fallback
          delay: '0'
          value_type: LOG
          trends: '0'
          description: 'The item is used to collect all SNMP traps unmatched by other snmptrap items'
          logtimefmt: 'hh:mm:sszyyyy/MM/dd'
          tags:
            - tag: component
              value: network
        - uuid: 27a9575fd7d9495681ba7e83333def09
          name: 'System contact details'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.4.0]'
          key: 'system.contact[sysContact.0]'
          delay: 15m
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person. If no contact information is known, the value is the zero-length string.
          inventory_link: CONTACT
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: b92b05da9ffb488bace37b3d034ed3e9
          name: 'Interrupts per second'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.11.59.0]'
          key: 'system.cpu.intr[ssRawInterrupts.0]'
          value_type: FLOAT
          description: 'Number of interrupts processed.'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            - tag: component
              value: cpu
        - uuid: 8509d868ae834d86a1b8d94cd8aa27e8
          name: 'Load average (1m avg)'
          type: DEPENDENT
          key: 'system.cpu.load.avg1[laLoad.1]'
          delay: '0'
          value_type: FLOAT
          description: 'MIB: UCD-SNMP-MIB'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$[?(@.laName == ''Load-1'')].laLoad.first()'
          master_item:
            key: system.cpu.load.walk
          tags:
            - tag: component
              value: cpu
        - uuid: c153b77a25ff4976bc60c41289a33626
          name: 'Load average (5m avg)'
          type: DEPENDENT
          key: 'system.cpu.load.avg5[laLoad.2]'
          delay: '0'
          value_type: FLOAT
          description: 'MIB: UCD-SNMP-MIB'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$[?(@.laName == ''Load-5'')].laLoad.first()'
          master_item:
            key: system.cpu.load.walk
          tags:
            - tag: component
              value: cpu
        - uuid: f508602b99b94a68a996ab4f3f19b7e8
          name: 'Load average (15m avg)'
          type: DEPENDENT
          key: 'system.cpu.load.avg15[laLoad.3]'
          delay: '0'
          value_type: FLOAT
          description: 'MIB: UCD-SNMP-MIB'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$[?(@.laName == ''Load-15'')].laLoad.first()'
          master_item:
            key: system.cpu.load.walk
          tags:
            - tag: component
              value: cpu
        - uuid: 3973a5eff7414340b3adcd9255770ad6
          name: 'SNMP walk CPU load averages'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.2021.10.1.2,1.3.6.1.4.1.2021.10.1.3]'
          key: system.cpu.load.walk
          history: '0'
          value_type: TEXT
          trends: '0'
          description: |
            MIB: UCD-SNMP-MIB
            SNMP walk through laTable. The collected data used in dependent CPU load average items.
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - laName
                - 1.3.6.1.4.1.2021.10.1.2
                - '0'
                - laLoad
                - 1.3.6.1.4.1.2021.10.1.3
                - '0'
          tags:
            - tag: component
              value: cpu
            - tag: component
              value: raw
        - uuid: 27167dc584624ab98550989558cbb65a
          name: 'Number of CPUs'
          type: DEPENDENT
          key: 'system.cpu.num[snmp]'
          delay: '0'
          description: 'Count the number of CPU cores by counting number of cores discovered in hrProcessorTable using LLD.'
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#SNMPVALUE}'
                - 1.3.6.1.2.1.25.3.3.1.1
                - '0'
            - type: JAVASCRIPT
              parameters:
                - 'return JSON.parse(value).length;'
          master_item:
            key: system.cpu.walk
          tags:
            - tag: component
              value: cpu
        - uuid: e0ee6327bbca46a9a41d46ea6a52a4ee
          name: 'Context switches per second'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.11.60.0]'
          key: 'system.cpu.switches[ssRawContexts.0]'
          value_type: FLOAT
          description: 'The combined rate at which all processors on the computer are switched from one thread to another.'
          preprocessing:
            - type: CHANGE_PER_SECOND
              parameters:
                - ''
          tags:
            - tag: component
              value: cpu
        - uuid: ff677db405bc449dafa2167c6cddb182
          name: 'SNMP walk system CPUs'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.2.1.25.3.3.1.1,1.3.6.1.4.1.2021.11.53.0,1.3.6.1.4.1.2021.11.52.0,1.3.6.1.4.1.2021.11.50.0,1.3.6.1.4.1.2021.11.64.0,1.3.6.1.4.1.2021.11.61.0,1.3.6.1.4.1.2021.11.51.0,1.3.6.1.4.1.2021.11.54.0,1.3.6.1.4.1.2021.11.56.0,1.3.6.1.4.1.2021.11.65.0,1.3.6.1.4.1.2021.11.66.0]'
          key: system.cpu.walk
          history: '0'
          value_type: TEXT
          trends: '0'
          description: |
            MIB: HOST-RESOURCES-MIB
            Discovering system CPUs.
          tags:
            - tag: component
              value: cpu
            - tag: component
              value: raw
        - uuid: 81598779d91f406990b574ebef92a953
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.1.0]'
          key: 'system.descr[sysDescr.0]'
          delay: 15m
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            A textual description of the entity. This value should
            include the full name and version identification of the system's hardware type, software operating-system, and
            networking software.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 4e38e42dc8784a37beab8e962524b144
          name: 'Uptime (hardware)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.25.1.1.0]'
          key: 'system.hw.uptime[hrSystemUptime.0]'
          delay: 30s
          trends: '0'
          units: uptime
          description: |
            MIB: HOST-RESOURCES-MIB
            The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.
          preprocessing:
            - type: CHECK_NOT_SUPPORTED
              parameters:
                - '-1'
              error_handler: CUSTOM_VALUE
              error_handler_params: '0'
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: bb7ce2aa75b34c639ecd46efc271fb1d
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.6.0]'
          key: 'system.location[sysLocation.0]'
          delay: 15m
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            Physical location of the node (e.g., `equipment room`, `3rd floor`). If not provided, the value is a zero-length string.
          inventory_link: LOCATION
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: eda9e318a8d94c9d9f4eec30b1ca59e5
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.5.0]'
          key: system.name
          delay: 15m
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name. If the name is unknown, the value is the zero-length string.
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 76fbcd15c5d94bfb981f01f60ade386e
              expression: 'last(/Unifi by SNMP/system.name,#1)<>last(/Unifi by SNMP/system.name,#2) and length(last(/Unifi by SNMP/system.name))>0'
              name: 'Linux: System name has changed'
              event_name: 'Linux: System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'The name of the system has changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
                - tag: scope
                  value: security
        - uuid: 9cc6423a665642eca6ed2ded94ecd769
          name: 'Uptime (network)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.3.0]'
          key: 'system.net.uptime[sysUpTime.0]'
          delay: 30s
          trends: '0'
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            Time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: 31dfa30b828744ef9b4f4a8093c6c026
          name: 'System object ID'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.2.1.1.2.0]'
          key: 'system.objectid[sysObjectID.0]'
          delay: 15m
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            The vendor's authoritative identification of the network management subsystem contained in the entity. This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 27ffe692cb73415595eece563ee51f66
          name: 'Free swap space'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.4.4.0]'
          key: 'system.swap.free[memAvailSwap.0]'
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            The amount of swap space currently unused or available.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
            - tag: component
              value: storage
        - uuid: ef8c9c7b1ee94762957b1d0ca5a13a3e
          name: 'Free swap space in %'
          type: CALCULATED
          key: 'system.swap.pfree[snmp]'
          value_type: FLOAT
          status: DISABLED
          units: '%'
          params: 'last(//system.swap.free[memAvailSwap.0])/last(//system.swap.total[memTotalSwap.0])*100'
          description: 'The free space of the swap volume/file expressed in %.'
          tags:
            - tag: component
              value: memory
            - tag: component
              value: storage
        - uuid: 59c574d7c64b40228d5003b6ed1f14a9
          name: 'Total swap space'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.4.3.0]'
          key: 'system.swap.total[memTotalSwap.0]'
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            The total amount of swap space configured for this host.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
            - tag: component
              value: storage
        - uuid: 964792684bc14fe687f5b07aa17b3d90
          name: 'SNMP walk block devices'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.2021.13.15.1.1.2,1.3.6.1.4.1.2021.13.15.1.1.5,1.3.6.1.4.1.2021.13.15.1.1.6,1.3.6.1.4.1.2021.13.15.1.1.9]'
          key: vfs.dev.walk
          history: '0'
          value_type: TEXT
          trends: '0'
          description: 'Block devices are discovered from UCD-DISKIO-MIB::diskIOTable (http://net-snmp.sourceforge.net/docs/mibs/ucdDiskIOMIB.html#diskIOTable).'
          tags:
            - tag: component
              value: raw
        - uuid: 181c3b7bc47f4e6aafb181dd24652d93
          name: 'SNMP walk mounted filesystems'
          type: SNMP_AGENT
          snmp_oid: 'walk[1.3.6.1.4.1.2021.9.1.1,1.3.6.1.4.1.2021.9.1.2,1.3.6.1.4.1.2021.9.1.3,1.3.6.1.4.1.2021.9.1.10,1.3.6.1.4.1.2021.9.1.11,1.3.6.1.4.1.2021.9.1.12,1.3.6.1.4.1.2021.9.1.13,1.3.6.1.4.1.2021.9.1.14,1.3.6.1.4.1.2021.9.1.15,1.3.6.1.4.1.2021.9.1.16]'
          key: vfs.fs.walk
          history: '0'
          value_type: TEXT
          trends: '0'
          description: |
            MIB: UCD-SNMP-MIB
            Snmp walk through dskEntry table. Collected data used in filesystem lld and dependent item prototypes.
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - dskPath
                - 1.3.6.1.4.1.2021.9.1.2
                - '0'
                - dskDevice
                - 1.3.6.1.4.1.2021.9.1.3
                - '0'
                - dskPercentNode
                - 1.3.6.1.4.1.2021.9.1.10
                - '0'
                - dskTotalLow
                - 1.3.6.1.4.1.2021.9.1.11
                - '0'
                - dskTotalHigh
                - 1.3.6.1.4.1.2021.9.1.12
                - '0'
                - dskAvailLow
                - 1.3.6.1.4.1.2021.9.1.13
                - '0'
                - dskAvailHigh
                - 1.3.6.1.4.1.2021.9.1.14
                - '0'
                - dskUsedLow
                - 1.3.6.1.4.1.2021.9.1.15
                - '0'
                - dskUsedHigh
                - 1.3.6.1.4.1.2021.9.1.16
                - '0'
                - dskEntry
                - 1.3.6.1.4.1.2021.9.1.1
                - '0'
          tags:
            - tag: component
              value: raw
            - tag: component
              value: storage
        - uuid: c9d0175f27bb42f3aac556da2c269362
          name: 'Available memory'
          type: CALCULATED
          key: 'vm.memory.available[snmp]'
          units: B
          params: 'last(//vm.memory.free[memAvailReal.0])+last(//vm.memory.buffers[memBuffer.0])+last(//vm.memory.cached[memCached.0])'
          description: 'Please note that memory utilization is a rough estimate, since memory available is calculated as free+buffers+cached, which is not 100% accurate, but the best we can get using SNMP.'
          tags:
            - tag: component
              value: memory
        - uuid: 62f002d8e42743b09d8953ca5c6b7e49
          name: 'Memory (buffers)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.4.14.0]'
          key: 'vm.memory.buffers[memBuffer.0]'
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            Memory used by kernel buffers (Buffers in /proc/meminfo).
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: deace11b8cc94506b0bb5b1230cd94f5
          name: 'Memory (cached)'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.4.15.0]'
          key: 'vm.memory.cached[memCached.0]'
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            Memory used by the page cache and slabs (Cached and Slab in /proc/meminfo).
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: 6a716da30d094d57be8ea081a4b84e4a
          name: 'Free memory'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.4.6.0]'
          key: 'vm.memory.free[memAvailReal.0]'
          units: B
          description: 'MIB: UCD-SNMP-MIB'
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: 260b0164b157459598bba0a8c31ad960
          name: 'Total memory'
          type: SNMP_AGENT
          snmp_oid: 'get[1.3.6.1.4.1.2021.4.5.0]'
          key: 'vm.memory.total[memTotalReal.0]'
          units: B
          description: |
            MIB: UCD-SNMP-MIB
            Total memory expressed in bytes.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            - tag: component
              value: memory
        - uuid: 6ad26331b00c44dfbb762d68f3e8cf21
          name: 'Memory utilization'
          type: CALCULATED
          key: 'vm.memory.util[snmp]'
          value_type: FLOAT
          units: '%'
          params: '(last(//vm.memory.total[memTotalReal.0])-(last(//vm.memory.free[memAvailReal.0])+last(//vm.memory.buffers[memBuffer.0])+last(//vm.memory.cached[memCached.0])))/last(//vm.memory.total[memTotalReal.0])*100'
          description: 'Please note that memory utilization is a rough estimate, since memory available is calculated as free+buffers+cached, which is not 100% accurate, but the best we can get using SNMP.'
          tags:
            - tag: component
              value: memory
          triggers:
            - uuid: 237afd58868a4bbeb503bfae5a0b2691
              expression: 'min(/Unifi by SNMP/vm.memory.util[snmp],5m)>{$MEMORY.UTIL.MAX}'
              name: 'Linux: High memory utilization'
              event_name: 'Linux: High memory utilization (>{$MEMORY.UTIL.MAX}% for 5m)'
              priority: AVERAGE
              description: 'The system is running out of free memory.'
              dependencies:
                - name: 'Linux: Lack of available memory'
                  expression: 'max(/Unifi by SNMP/vm.memory.available[snmp],5m)<{$MEMORY.AVAILABLE.MIN} and last(/Unifi by SNMP/vm.memory.total[memTotalReal.0])>0'
              tags:
                - tag: scope
                  value: capacity
                - tag: scope
                  value: performance
        - uuid: f7f2aeb95a5e4e5c897afc514ed688a0
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          description: |
            Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.
            Possible values:
            0 - not available
            1 - available
            2 - unknown
          valuemap:
            name: zabbix.host.available
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: 4d44ffbd684e4b53bc21f3728b38abd8
              expression: 'max(/Unifi by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: 'Linux: No SNMP data collection'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              dependencies:
                - name: 'Linux: Unavailable by ICMP ping'
                  expression: 'max(/Unifi by SNMP/icmpping,#3)=0'
              tags:
                - tag: scope
                  value: availability
      discovery_rules:
        - uuid: c640c44045794ccea8989058eb6f0f79
          name: 'CPU discovery'
          type: DEPENDENT
          key: 'cpu.discovery[snmp]'
          delay: '0'
          description: 'This discovery will create set of per core CPU metrics from UCD-SNMP-MIB, using {#CPU.COUNT} in preprocessing. That''s the only reason why LLD is used.'
          item_prototypes:
            - uuid: bad7cd130f6d40ff8fb7606b07a28143
              name: 'CPU guest time'
              type: DEPENDENT
              key: 'system.cpu.guest[ssCpuRawGuest.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time spent on running a virtual CPU for a guest operating system.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.65.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 8910e0e6094f43419fbd2376dc4ebedb
              name: 'CPU guest nice time'
              type: DEPENDENT
              key: 'system.cpu.guest_nice[ssCpuRawGuestNice.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time spent on running a niced guest (a virtual CPU for guest operating systems under the control of the Linux kernel).
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.66.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 9f81a0415ac0408aad09a48e0686b9c1
              name: 'CPU idle time'
              type: DEPENDENT
              key: 'system.cpu.idle[ssCpuRawIdle.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has spent doing nothing.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.53.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: a6eedd00ea2346129fe5a3b7f7ea40ae
              name: 'CPU interrupt time'
              type: DEPENDENT
              key: 'system.cpu.interrupt[ssCpuRawInterrupt.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has spent servicing hardware interrupts.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.56.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 7387a3b580eb436e9957fa7985322845
              name: 'CPU iowait time'
              type: DEPENDENT
              key: 'system.cpu.iowait[ssCpuRawWait.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has been waiting for I/O to complete.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.54.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 2ec0864608774f3eac3cedb12e534d00
              name: 'CPU nice time'
              type: DEPENDENT
              key: 'system.cpu.nice[ssCpuRawNice.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has spent running users' processes that have been niced.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.51.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 7312fcf719e24b2e8022613e2dbe6f91
              name: 'CPU softirq time'
              type: DEPENDENT
              key: 'system.cpu.softirq[ssCpuRawSoftIRQ.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has been servicing software interrupts.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.61.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 82fe1f2d0f4548419b67cdab5a13f56a
              name: 'CPU steal time'
              type: DEPENDENT
              key: 'system.cpu.steal[ssCpuRawSteal.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                The amount of "stolen" CPU from this virtual machine by the hypervisor for other tasks, such as running another virtual machine.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.64.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 01386db608224fa0837feb72276a6fef
              name: 'CPU system time'
              type: DEPENDENT
              key: 'system.cpu.system[ssCpuRawSystem.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has spent running the kernel and its processes.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.52.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 2bfe3f9422b64efeadf8880fe6bed5a9
              name: 'CPU user time'
              type: DEPENDENT
              key: 'system.cpu.user[ssCpuRawUser.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Time the CPU has spent running users' processes that are not niced.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - 1.3.6.1.4.1.2021.11.50.0
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: JAVASCRIPT
                  parameters:
                    - 'return value/{#CPU.COUNT}'
              master_item:
                key: system.cpu.walk
              tags:
                - tag: component
                  value: cpu
            - uuid: 3da027f16cb64026a2d9d59327e20783
              name: 'CPU utilization'
              type: DEPENDENT
              key: 'system.cpu.util[snmp,{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: 'CPU utilization expressed in %.'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - 'return (100 - value)'
              master_item:
                key: 'system.cpu.idle[ssCpuRawIdle.{#SNMPINDEX}]'
              tags:
                - tag: component
                  value: cpu
              trigger_prototypes:
                - uuid: 249a6d0d892f44f7b9c4c5bb2138cdc9
                  expression: 'min(/Unifi by SNMP/system.cpu.util[snmp,{#SNMPINDEX}],5m)>{$CPU.UTIL.CRIT}'
                  name: 'Linux: High CPU utilization'
                  event_name: 'Linux: High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)'
                  opdata: 'Current utilization: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'CPU utilization is too high. The system might be slow to respond.'
                  tags:
                    - tag: scope
                      value: performance
          graph_prototypes:
            - uuid: 931145de6bc649519061a1d283e22b1f
              name: 'Linux: CPU usage{#SINGLETON}'
              type: STACKED
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - color: 199C0D
                  item:
                    host: 'Unifi by SNMP'
                    key: 'system.cpu.system[ssCpuRawSystem.{#SNMPINDEX}]'
                - sortorder: '1'
                  color: F63100
                  item:
                    host: 'Unifi by SNMP'
                    key: 'system.cpu.user[ssCpuRawUser.{#SNMPINDEX}]'
                - sortorder: '2'
                  color: 00611C
                  item:
                    host: 'Unifi by SNMP'
                    key: 'system.cpu.nice[ssCpuRawNice.{#SNMPINDEX}]'
                - sortorder: '3'
                  color: F7941D
                  item:
                    host: 'Unifi by SNMP'
                    key: 'system.cpu.iowait[ssCpuRawWait.{#SNMPINDEX}]'
                - sortorder: '4'
                  color: FC6EA3
                  item:
                    host: 'Unifi by SNMP'
                    key: 'system.cpu.steal[ssCpuRawSteal.{#SNMPINDEX}]'
                - sortorder: '5'
                  color: 6C59DC
                  item:
                    host: 'Unifi by SNMP'
                    key: 'system.cpu.interrupt[ssCpuRawInterrupt.{#SNMPINDEX}]'
                - sortorder: '6'
                  color: C7A72D
                  item:
                    host: 'Unifi by SNMP'
                    key: 'system.cpu.softirq[ssCpuRawSoftIRQ.{#SNMPINDEX}]'
                - sortorder: '7'
                  color: BA2A5D
                  item:
                    host: 'Unifi by SNMP'
                    key: 'system.cpu.guest[ssCpuRawGuest.{#SNMPINDEX}]'
                - sortorder: '8'
                  color: F230E0
                  item:
                    host: 'Unifi by SNMP'
                    key: 'system.cpu.guest_nice[ssCpuRawGuestNice.{#SNMPINDEX}]'
            - uuid: 4c9ba12cfea340d8a7d2a7d79ddee00e
              name: 'Linux: CPU utilization{#SINGLETON}'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'Unifi by SNMP'
                    key: 'system.cpu.util[snmp,{#SNMPINDEX}]'
          master_item:
            key: 'system.cpu.num[snmp]'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'return JSON.stringify([{"{#CPU.COUNT}": value, "{#SNMPINDEX}": 0, "{#SINGLETON}":""}])'
        - uuid: 0909402c34d4469f95294c6125bd8390
          name: 'Network interfaces discovery'
          type: DEPENDENT
          key: net.if.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.MATCHES}'
                formulaid: A
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
                formulaid: C
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.MATCHES}'
                formulaid: E
              - macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: F
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
                formulaid: G
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: H
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.MATCHES}'
                formulaid: I
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: J
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.MATCHES}'
                formulaid: K
              - macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: L
          description: 'Discovering interfaces from IF-MIB.'
          item_prototypes:
            - uuid: ee3c01a2315e47ad952d37168be36020
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded'
              type: DEPENDENT
              key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              delay: '0'
              description: |
                MIB: IF-MIB
                The number of inbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: ed6df81e1ab2495eb30a8edf135448c7
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors'
              type: DEPENDENT
              key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              delay: '0'
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 3f7d30be4e7b411aab8eff341f0bc2a4
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
              type: DEPENDENT
              key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              delay: '0'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface, including framing characters. This object is a 64-bit version of ifInOctets. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 81246d4d288d4b539043f06324f2c7a1
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded'
              type: DEPENDENT
              key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              delay: '0'
              description: |
                MIB: IF-MIB
                The number of outbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 2ef06f4423b64602af7552fa4989ae88
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors'
              type: DEPENDENT
              key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              delay: '0'
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 3m
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 0709ecfe96fb4d48b5c3a3bbdd7dfbc7
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
              type: DEPENDENT
              key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              delay: '0'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of ifOutOctets.Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 7ba8d41cf17f40179047581946b23c2a
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: DEPENDENT
              key: 'net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              delay: '0'
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in units of 1,000,000 bits per second. If this object reports a value of `n`, then the speed of the interface is somewhere in the range of `n-500,000` to `n+499,999`.
                For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth.
                For a sub-layer which has no concept of bandwidth, this object should be zero.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
                    - '0'
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 57c7f0edf776402b9de0c3ffeb75ca32
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: DEPENDENT
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              delay: '0'
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              valuemap:
                name: 'IF-MIB::ifOperStatus'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 8b9bacb2ee37492d804ce08423a169bd
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Linux: Interface {#IFNAME}({#IFALIAS}): Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. It can be triggered if the operations status is down.
                    2. `{$IFCONTROL:"{#IFNAME}"}=1` - a user can redefine the context macro to "0", marking this interface as not important. No new trigger will be fired if this interface is down.
                    3. `last(/TEMPLATE_NAME/METRIC,#1)<>last(/TEMPLATE_NAME/METRIC,#2)` - the trigger fires only if the operational status was up to (1) sometime before (so, does not fire for "eternal off" interfaces.)

                    WARNING: if closed manually - it will not fire again on the next poll, because of .diff.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 179d3ceccb4c45d68c117b22404f97b0
              name: 'Interface {#IFNAME}({#IFALIAS}): Interface type'
              type: DEPENDENT
              key: 'net.if.type[ifType.{#SNMPINDEX}]'
              delay: '0'
              trends: '0'
              description: |
                MIB: IF-MIB
                The type of interface.
                Additional values for ifType are assigned by the Internet Assigned Numbers Authority (IANA),
                through updating the syntax of the IANAifType textual convention.
              valuemap:
                name: 'IF-MIB::ifType'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}'
                    - '0'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: net.if.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
          trigger_prototypes:
            - uuid: 1cf953835e9546abb24d04a41b07bf90
              expression: |
                change(/Unifi by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])<0 and last(/Unifi by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
                and (
                last(/Unifi by SNMP/net.if.type[ifType.{#SNMPINDEX}])=6 or
                last(/Unifi by SNMP/net.if.type[ifType.{#SNMPINDEX}])=7 or
                last(/Unifi by SNMP/net.if.type[ifType.{#SNMPINDEX}])=11 or
                last(/Unifi by SNMP/net.if.type[ifType.{#SNMPINDEX}])=62 or
                last(/Unifi by SNMP/net.if.type[ifType.{#SNMPINDEX}])=69 or
                last(/Unifi by SNMP/net.if.type[ifType.{#SNMPINDEX}])=117
                )
                and
                (last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                (change(/Unifi by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 and last(/Unifi by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}],#2)>0) or
                (last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2)
              name: 'Linux: Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed than it was before'
              opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              dependencies:
                - name: 'Linux: Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
            - uuid: 9190537e10fc42c1a6d2c3f0ab2198b5
              expression: |
                (avg(/Unifi by SNMP/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Unifi by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
                avg(/Unifi by SNMP/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Unifi by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
                last(/Unifi by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/Unifi by SNMP/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Unifi by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
                avg(/Unifi by SNMP/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Unifi by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])
              name: 'Linux: Interface {#IFNAME}({#IFALIAS}): High bandwidth usage'
              event_name: 'Linux: Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (>{$IF.UTIL.MAX:"{#IFNAME}"}%)'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The utilization of the network interface is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              dependencies:
                - name: 'Linux: Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: performance
            - uuid: 596ae7378e364e7eba3357e5cdfaf0fb
              expression: |
                min(/Unifi by SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/Unifi by SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/Unifi by SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/Unifi by SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Linux: Interface {#IFNAME}({#IFALIAS}): High error rate'
              event_name: 'Linux: Interface {#IFNAME}({#IFALIAS}): High error rate (>{$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'It recovers when it is below 80% of the `{$IF.ERRORS.WARN:"{#IFNAME}"}` threshold.'
              manual_close: 'YES'
              dependencies:
                - name: 'Linux: Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
                  recovery_expression: 'last(/Unifi by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
          graph_prototypes:
            - uuid: 4f0bed88a03f4863b57c37e49ced8d16
              name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
              graph_items:
                - drawtype: GRADIENT_LINE
                  color: 199C0D
                  item:
                    host: 'Unifi by SNMP'
                    key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
                - sortorder: '1'
                  drawtype: BOLD_LINE
                  color: F63100
                  item:
                    host: 'Unifi by SNMP'
                    key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
                - sortorder: '2'
                  color: 00611C
                  yaxisside: RIGHT
                  item:
                    host: 'Unifi by SNMP'
                    key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
                - sortorder: '3'
                  color: F7941D
                  yaxisside: RIGHT
                  item:
                    host: 'Unifi by SNMP'
                    key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
                - sortorder: '4'
                  color: FC6EA3
                  yaxisside: RIGHT
                  item:
                    host: 'Unifi by SNMP'
                    key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
                - sortorder: '5'
                  color: 6C59DC
                  yaxisside: RIGHT
                  item:
                    host: 'Unifi by SNMP'
                    key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
          master_item:
            key: net.if.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#IFOPERSTATUS}'
                - 1.3.6.1.2.1.2.2.1.8
                - '0'
                - '{#IFADMINSTATUS}'
                - 1.3.6.1.2.1.2.2.1.7
                - '0'
                - '{#IFALIAS}'
                - 1.3.6.1.2.1.31.1.1.1.18
                - '0'
                - '{#IFNAME}'
                - 1.3.6.1.2.1.31.1.1.1.1
                - '0'
                - '{#IFDESCR}'
                - 1.3.6.1.2.1.2.2.1.2
                - '0'
                - '{#IFTYPE}'
                - 1.3.6.1.2.1.2.2.1.3
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 4b55c7576b4d47e9964c77fd911dfe7e
          name: 'EtherLike-MIB Discovery'
          type: DEPENDENT
          key: net.if.duplex.discovery
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFOPERSTATUS}'
                value: '1'
                formulaid: A
              - macro: '{#SNMPVALUE}'
                value: (2|3)
                formulaid: B
              - macro: '{#SNMPVALUE}'
                operator: EXISTS
                formulaid: C
          description: 'Discovering interfaces from IF-MIB and EtherLike-MIB. Interfaces with `up(1)` Operational Status are discovered.'
          item_prototypes:
            - uuid: fc86b69baed84be9a0269bfe1d9f7a77
              name: 'Interface {#IFNAME}({#IFALIAS}): Duplex status'
              type: DEPENDENT
              key: 'net.if.duplex[dot3StatsDuplexStatus.{#SNMPINDEX}]'
              delay: '0'
              description: |
                MIB: EtherLike-MIB
                The current mode of operation of the MAC entity. `unknown` indicates that the current duplex mode could not be determined.
                Management control of the duplex mode is accomplished through the MAU MIB. When an interface does not support autonegotiation or when autonegotiation is not enabled, the duplex mode is controlled using `ifMauDefaultType`. When autonegotiation is supported and enabled, duplex mode is controlled using `ifMauAutoNegAdvertisedBits`. In either case, the currently operating duplex mode in reflected both in this object and in `ifMauType`.
                Note that this object provides redundant information with `ifMauType`. Normally, redundant objects are discouraged. However, in this instance, it allows a management application to determine the duplex status of an interface without having to know every possible value of `ifMauType`. This was felt to be sufficiently valuable to justify the redundancy.
                Reference: [IEEE 802.3 Std.], 30.3.1.1.32,aDuplexStatus.
              valuemap:
                name: 'EtherLike-MIB::dot3StatsDuplexStatus'
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.2.1.10.7.2.1.19.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: net.if.duplex.walk
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 4896ca99d49f4c8799e346a3ac50aa6c
                  expression: 'last(/Unifi by SNMP/net.if.duplex[dot3StatsDuplexStatus.{#SNMPINDEX}])=2'
                  name: 'Linux: Interface {#IFNAME}({#IFALIAS}): In half-duplex mode'
                  priority: WARNING
                  description: 'Please check autonegotiation settings and cabling.'
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: performance
          master_item:
            key: net.if.duplex.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#SNMPVALUE}'
                - 1.3.6.1.2.1.10.7.2.1.19
                - '0'
                - '{#IFOPERSTATUS}'
                - 1.3.6.1.2.1.2.2.1.8
                - '0'
                - '{#IFALIAS}'
                - 1.3.6.1.2.1.31.1.1.1.18
                - '0'
                - '{#IFNAME}'
                - 1.3.6.1.2.1.31.1.1.1.1
                - '0'
                - '{#IFDESCR}'
                - 1.3.6.1.2.1.2.2.1.2
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: 3536fd9b9c9748f49a58c5c01e060333
          name: 'UAP devices'
          type: DEPENDENT
          key: unifi.device.uap.discovery
          delay: '0'
          filter:
            conditions:
              - macro: '{#NAME}'
                value: ^uap$
                formulaid: A
          master_item:
            key: system.name
        - uuid: 99c82dcbf9aa430a970eeaf434038ee3
          name: USW_devices
          type: DEPENDENT
          key: unifi.device.usw.discovery
          delay: '0'
          filter:
            conditions:
              - macro: '{#NAME}'
                value: ^usw$
                formulaid: A
          lifetime: 30d
          host_prototypes:
            - uuid: 9307ceded08e4370a26c482184dc183e
              host: '{#NAME}'
              name: '{#NAME}'
              group_links:
                - group:
                    name: 'Discovered hosts'
              templates:
                - name: 'Unifi by SNMP'
          master_item:
            key: system.name
        - uuid: 36d30c7bf04e4e1d837ee87e18e2da93
          name: 'Block devices discovery'
          type: DEPENDENT
          key: 'vfs.dev.discovery[snmp]'
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.MATCHES}'
                formulaid: A
              - macro: '{#DEVNAME}'
                value: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
          description: 'Block devices are discovered from UCD-DISKIO-MIB::diskIOTable (http://net-snmp.sourceforge.net/docs/mibs/ucdDiskIOMIB.html#diskIOTable)'
          item_prototypes:
            - uuid: 6a9b91169063400f96532ea5f21e48c9
              name: '{#DEVNAME}: Disk read rate'
              type: DEPENDENT
              key: 'vfs.dev.read.rate[diskIOReads.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '!r/s'
              description: |
                MIB: UCD-DISKIO-MIB
                The number of read accesses from this device since boot.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.2021.13.15.1.1.5.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: vfs.dev.walk
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
            - uuid: e0da4c9cd34b48c2a950f4c768328fbe
              name: '{#DEVNAME}: Disk utilization'
              type: DEPENDENT
              key: 'vfs.dev.util[diskIOLA1.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-DISKIO-MIB
                The 1 minute average load of disk (%)
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.2021.13.15.1.1.9.{#SNMPINDEX}'
                    - '0'
              master_item:
                key: vfs.dev.walk
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
            - uuid: 357b4a05ada4429e8a83dcc83f484274
              name: '{#DEVNAME}: Disk write rate'
              type: DEPENDENT
              key: 'vfs.dev.write.rate[diskIOWrites.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '!w/s'
              description: |
                MIB: UCD-DISKIO-MIB
                The number of write accesses from this device since boot.
              preprocessing:
                - type: SNMP_WALK_VALUE
                  parameters:
                    - '1.3.6.1.4.1.2021.13.15.1.1.6.{#SNMPINDEX}'
                    - '0'
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              master_item:
                key: vfs.dev.walk
              tags:
                - tag: component
                  value: storage
                - tag: disk
                  value: '{#DEVNAME}'
          graph_prototypes:
            - uuid: 3a0a0459869a4e5c8ca23dd603f2e34f
              name: '{#DEVNAME}: Disk read/write rates'
              graph_items:
                - color: 199C0D
                  item:
                    host: 'Unifi by SNMP'
                    key: 'vfs.dev.read.rate[diskIOReads.{#SNMPINDEX}]'
                - sortorder: '1'
                  drawtype: GRADIENT_LINE
                  color: F63100
                  item:
                    host: 'Unifi by SNMP'
                    key: 'vfs.dev.write.rate[diskIOWrites.{#SNMPINDEX}]'
          master_item:
            key: vfs.dev.walk
          preprocessing:
            - type: SNMP_WALK_TO_JSON
              parameters:
                - '{#DEVNAME}'
                - 1.3.6.1.4.1.2021.13.15.1.1.2
                - '0'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
        - uuid: b5e4237d82cb4f3186d027dc038c4c55
          name: 'Mounted filesystem discovery'
          type: DEPENDENT
          key: 'vfs.fs.discovery[snmp]'
          delay: '0'
          filter:
            evaltype: AND
            conditions:
              - macro: '{#FSDEVICE}'
                value: '{$VFS.FS.FSDEVICE.MATCHES}'
                formulaid: A
              - macro: '{#FSDEVICE}'
                value: '{$VFS.FS.FSDEVICE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.MATCHES}'
                formulaid: C
              - macro: '{#FSNAME}'
                value: '{$VFS.FS.FSNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
          description: 'UCD-SNMP-MIB::dskEntry table discovery with storage filter'
          item_prototypes:
            - uuid: 3733286d933242479f7c9e0dfd48afde
              name: 'FS [{#FSNAME}]: Space: Available'
              type: DEPENDENT
              key: 'vfs.fs.free[dskAvail.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: B
              description: |
                UCD-SNMP-MIB::dskEntry
                Available storage space is calculated from two portions:
                  dskAvailHigh
                  dskAvailLow
                Together they compose 64-bit number.
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const portionHigh = 4294967296;

                      const obj = JSON.parse(value);

                      const dskAvailHigh = parseInt(obj['dskAvailHigh'], 10),
                      	  dskAvailLow = parseInt(obj['dskAvailLow'], 10);

                      return (dskAvailHigh * portionHigh + dskAvailLow) * 1024;
              master_item:
                key: 'vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
            - uuid: 394ba765c03c43419450249b1aa5ff4c
              name: 'FS [{#FSNAME}]: Inodes: Free, in %'
              type: DEPENDENT
              key: 'vfs.fs.inode.pfree[{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                MIB: UCD-SNMP-MIB
                Free metadata space expressed as percentage.
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var obj = JSON.parse(value);
                      var dskPercentNode = obj['dskPercentNode'];

                      return (100 - dskPercentNode);
              master_item:
                key: 'vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
              trigger_prototypes:
                - uuid: e810c74e8b984d4d83f1ed7548ce0cf9
                  expression: 'min(/Unifi by SNMP/vfs.fs.inode.pfree[{#SNMPINDEX}],5m)<{$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}'
                  name: 'Linux: FS [{#FSNAME}]: Running out of free inodes'
                  event_name: 'Linux: FS [{#FSNAME}]: Running out of free inodes (free < {$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}%)'
                  opdata: 'Free inodes: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Disk writing may fail if index nodes are exhausted, leading to error messages like "No space left on device" or "Disk is full", despite available free space.'
                  tags:
                    - tag: scope
                      value: capacity
                    - tag: scope
                      value: performance
                - uuid: b5e4437ef2014d958ca7016884550eb8
                  expression: 'min(/Unifi by SNMP/vfs.fs.inode.pfree[{#SNMPINDEX}],5m)<{$VFS.FS.INODE.PFREE.MIN.WARN:"{#FSNAME}"}'
                  name: 'Linux: FS [{#FSNAME}]: Running out of free inodes'
                  event_name: 'Linux: FS [{#FSNAME}]: Running out of free inodes (free < {$VFS.FS.INODE.PFREE.MIN.WARN:"{#FSNAME}"}%)'
                  opdata: 'Free inodes: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'Disk writing may fail if index nodes are exhausted, leading to error messages like "No space left on device" or "Disk is full", despite available free space.'
                  dependencies:
                    - name: 'Linux: FS [{#FSNAME}]: Running out of free inodes'
                      expression: 'min(/Unifi by SNMP/vfs.fs.inode.pfree[{#SNMPINDEX}],5m)<{$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}'
                  tags:
                    - tag: scope
                      value: capacity
                    - tag: scope
                      value: performance
            - uuid: b09f81a10b7044dfa903e8411e65281b
              name: 'FS [{#FSNAME}]: Space: Used, in %'
              type: DEPENDENT
              key: 'vfs.fs.pused[{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: '%'
              description: |
                UCD-SNMP-MIB::dskEntry
                Space utilization is calculated as the percentage of currently used space compared to the maximum available space.
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const portionHigh = 4294967296;

                      const obj = JSON.parse(value);

                      const dskAvailHigh = parseInt(obj['dskAvailHigh'], 10),
                      	  dskAvailLow = parseInt(obj['dskAvailLow'], 10),
                      	  dskUsedHigh = parseInt(obj['dskUsedHigh'], 10),
                      	  dskUsedLow = parseInt(obj['dskUsedLow'], 10);

                      const available = (dskAvailHigh * portionHigh + dskAvailLow) * 1024,
                      	  used = (dskUsedHigh * portionHigh + dskUsedLow) * 1024;

                      if ((available + used) <= 0) {
                      	return 0;
                      }

                      return used / (used + available) * 100;
              master_item:
                key: 'vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
              trigger_prototypes:
                - uuid: ab00cabad461413b87cdd4336488205d
                  expression: 'min(/Unifi by SNMP/vfs.fs.pused[{#SNMPINDEX}],5m)>{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}'
                  name: 'Linux: FS [{#FSNAME}]: Space is critically low'
                  event_name: 'Linux: FS [{#FSNAME}]: Space is critically low (used > {$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}%, total {{?last(//vfs.fs.total[dskTotal.{#SNMPINDEX}])/1024/1024/1024}.fmtnum(1)}GB)'
                  opdata: 'Space used: {{ITEM.LASTVALUE1}.fmtnum(1)}%'
                  priority: AVERAGE
                  description: |
                    The volume's space usage exceeds the '{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}%' limit;
                    The trigger expression is based on the current used and maximum available spaces.
                    Event name represents the total volume space, which can differ from the maximum available space, depending on the filesystem type.
                  manual_close: 'YES'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: capacity
                - uuid: 29407f8f4a7d45f3a20886d7ce61ebd7
                  expression: 'min(/Unifi by SNMP/vfs.fs.pused[{#SNMPINDEX}],5m)>{$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"}'
                  name: 'Linux: FS [{#FSNAME}]: Space is low'
                  event_name: 'Linux: FS [{#FSNAME}]: Space is low (used > {$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"}%, total {{?last(//vfs.fs.total[dskTotal.{#SNMPINDEX}])/1024/1024/1024}.fmtnum(1)}GB)'
                  opdata: 'Space used: {{ITEM.LASTVALUE1}.fmtnum(1)}%'
                  priority: WARNING
                  description: |
                    The volume's space usage exceeds the '{$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"}%' limit;
                    The trigger expression is based on the current used and maximum available spaces.
                    Event name represents the total volume space, which can differ from the maximum available space, depending on the filesystem type.
                  manual_close: 'YES'
                  dependencies:
                    - name: 'Linux: FS [{#FSNAME}]: Space is critically low'
                      expression: 'min(/Unifi by SNMP/vfs.fs.pused[{#SNMPINDEX}],5m)>{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}'
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: capacity
            - uuid: e8764f14ff164ea39ff9854f84a84223
              name: 'FS [{#FSNAME}]: Space: Total'
              type: DEPENDENT
              key: 'vfs.fs.total[dskTotal.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: B
              description: |
                MIB: UCD-SNMP-MIB
                Total storage is calculated from two portions:
                  dskTotalHigh
                  dskTotalLow
                Together they compose 64-bit number.
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const portionHigh = 4294967296;

                      const obj = JSON.parse(value);

                      const dskTotalHigh = parseInt(obj['dskTotalHigh'], 10),
                      	  dskTotalLow = parseInt(obj['dskTotalLow'], 10);

                      return (dskTotalHigh * portionHigh + dskTotalLow) * 1024;
              master_item:
                key: 'vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
            - uuid: 70dcdb865f20449cb1c5be6848a8ba1b
              name: 'FS [{#FSNAME}]: Space: Used'
              type: DEPENDENT
              key: 'vfs.fs.used[dskUsed.{#SNMPINDEX}]'
              delay: '0'
              value_type: FLOAT
              units: B
              description: |
                MIB: UCD-SNMP-MIB
                Used storage is calculated from two portions:
                  dskUsedHigh
                  dskUsedLow
                Together they compose 64-bit number.
                Reserved space is not counted in.
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      const portionHigh = 4294967296;

                      const obj = JSON.parse(value);

                      const dskUsedHigh = parseInt(obj['dskUsedHigh'], 10),
                      	  dskUsedLow = parseInt(obj['dskUsedLow'], 10);

                      return (dskUsedHigh * portionHigh + dskUsedLow) * 1024;
              master_item:
                key: 'vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]'
              tags:
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
            - uuid: 3977fb09833c4d1ca343f72ca027fbec
              name: 'FS [{#FSNAME}]: Get data'
              type: DEPENDENT
              key: 'vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]'
              delay: '0'
              history: 1h
              value_type: TEXT
              trends: '0'
              description: |
                MIB: UCD-SNMP-MIB
                Intermediate data for subsequent processing.
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      var data = JSON.parse(value);

                      result = data.filter(function(obj) {
                      	return obj["{\#SNMPINDEX}"] === "{#SNMPINDEX}";
                      })[0];

                      return JSON.stringify(result);
              master_item:
                key: vfs.fs.walk
              tags:
                - tag: component
                  value: raw
                - tag: component
                  value: storage
                - tag: filesystem
                  value: '{#FSNAME}'
          graph_prototypes:
            - uuid: 285c32e6d21d4f249f59daa3b2d3c002
              name: 'FS [{#FSNAME}]: Space usage graph, in % (relative to max available)'
              width: '600'
              height: '340'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - drawtype: FILLED_REGION
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'Unifi by SNMP'
                    key: 'vfs.fs.pused[{#SNMPINDEX}]'
            - uuid: 0a91b93b1c2e4c04996dbaface8d6b37
              name: 'FS [{#FSNAME}]: Space utilization chart (relative to total)'
              width: '600'
              height: '340'
              type: PIE
              show_3d: 'YES'
              graph_items:
                - color: '787878'
                  calc_fnc: LAST
                  type: GRAPH_SUM
                  item:
                    host: 'Unifi by SNMP'
                    key: 'vfs.fs.total[dskTotal.{#SNMPINDEX}]'
                - sortorder: '1'
                  color: F63100
                  calc_fnc: LAST
                  item:
                    host: 'Unifi by SNMP'
                    key: 'vfs.fs.used[dskUsed.{#SNMPINDEX}]'
                - sortorder: '2'
                  color: 199C09
                  calc_fnc: LAST
                  item:
                    host: 'Unifi by SNMP'
                    key: 'vfs.fs.free[dskAvail.{#SNMPINDEX}]'
          master_item:
            key: vfs.fs.walk
          lld_macro_paths:
            - lld_macro: '{#FSDEVICE}'
              path: $.dskDevice
            - lld_macro: '{#FSNAME}'
              path: $.dskPath
            - lld_macro: '{#SNMPINDEX}'
              path: $.index
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var filesystems = JSON.parse(value);

                  result = filesystems.map(function (filesystem) {
                  	return {
                  		'dskPath': filesystem.dskPath,
                  		'dskDevice': filesystem.dskDevice,
                  		'index': filesystem['{#SNMPINDEX}']
                  	};
                  });

                  return JSON.stringify(result);
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
      tags:
        - tag: class
          value: network
        - tag: target
          value: Unifi
      macros:
        - macro: '{$CPU.UTIL.CRIT}'
          value: '90'
          description: 'Critical threshold of CPU utilization expressed in %.'
        - macro: '{$ICMP_LOSS_WARN}'
          value: '20'
          description: 'Warning threshold of ICMP packet loss in %.'
        - macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
          description: 'Warning threshold of the average ICMP response time in seconds.'
        - macro: '{$IF.ERRORS.WARN}'
          value: '2'
          description: 'Warning threshold of error packet rate. Can be used with interface name as context.'
        - macro: '{$IF.UTIL.MAX}'
          value: '90'
          description: 'Used as a threshold in the interface utilization trigger.'
        - macro: '{$IFCONTROL}'
          value: '1'
          description: 'Link status trigger will be fired only for interfaces where the context macro equals "1".'
        - macro: '{$LOAD_AVG_PER_CPU.MAX.WARN}'
          value: '1.5'
          description: 'Load per CPU considered sustainable. Tune if needed.'
        - macro: '{$MEMORY.AVAILABLE.MIN}'
          value: 20M
          description: 'Used as a threshold in the available memory trigger.'
        - macro: '{$MEMORY.UTIL.MAX}'
          value: '90'
          description: 'Used as a threshold in the memory utilization trigger.'
        - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
          value: '^.*'
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
          value: ^2$
          description: 'Ignore `down(2)` administrative status'
        - macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
          description: 'Used for network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: '(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})'
          description: 'Filters out `loopbacks`, `nulls`, docker `veth` links and `docker0 bridge` by default.'
        - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
          value: '^.*$'
          description: 'Used for network interface discovery. Can be overridden on the host or linked template level.'
        - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
          value: ^6$
          description: 'Ignore `notPresent(6)`'
        - macro: '{$NET.IF.IFTYPE.MATCHES}'
          value: '.*'
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
          description: 'Used in network interface discovery rule filters.'
        - macro: '{$SNMP.TIMEOUT}'
          value: 5m
          description: 'Time interval for the SNMP availability trigger.'
        - macro: '{$SWAP.PFREE.MIN.WARN}'
          value: '50'
          description: 'The warning threshold of the minimum free swap.'
        - macro: '{$VFS.DEV.DEVNAME.MATCHES}'
          value: .+
          description: 'Used in block device discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
          value: '^(loop[0-9]*|sd[a-z][0-9]+|nbd[0-9]+|sr[0-9]+|fd[0-9]+|dm-[0-9]+|ram[0-9]+|ploop[a-z0-9]+|md[0-9]*|hcp[0-9]*|zram[0-9]*)'
          description: 'Used in block device discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSDEVICE.MATCHES}'
          value: .+
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSDEVICE.NOT_MATCHES}'
          value: '.*(tmpfs|shm)$'
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSNAME.MATCHES}'
          value: .+
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.FSNAME.NOT_MATCHES}'
          value: ^(/dev|/sys|/run|/proc|.+/shm$)
          description: 'Used in filesystem discovery. Can be overridden on the host or linked template level.'
        - macro: '{$VFS.FS.INODE.PFREE.MIN.CRIT}'
          value: '10'
          description: 'The critical threshold of the filesystem metadata utilization.'
        - macro: '{$VFS.FS.INODE.PFREE.MIN.WARN}'
          value: '20'
          description: 'The warning threshold of the filesystem metadata utilization.'
        - macro: '{$VFS.FS.PUSED.MAX.CRIT}'
          value: '90'
          description: 'The critical threshold of the filesystem utilization.'
        - macro: '{$VFS.FS.PUSED.MAX.WARN}'
          value: '80'
          description: 'The warning threshold of the filesystem utilization.'
      dashboards:
        - uuid: c058b117389e424b9ce10d54e4c74287
          name: Filesystems
          pages:
            - name: Overview
              widgets:
                - type: graphprototype
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '3'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Unifi by SNMP'
                        name: 'FS [{#FSNAME}]: Space utilization chart (relative to total)'
                    - type: STRING
                      name: reference
                      value: AAAEB
                - type: graphprototype
                  'y': '5'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Unifi by SNMP'
                        name: 'FS [{#FSNAME}]: Space usage graph, in % (relative to max available)'
                    - type: STRING
                      name: reference
                      value: AAAEC
        - uuid: 1884556a00f54499a05d5f961526b12e
          name: 'Network interfaces'
          pages:
            - widgets:
                - type: graphprototype
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Unifi by SNMP'
                        name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
                    - type: STRING
                      name: reference
                      value: AAAAI
        - uuid: b006d6cba5c44fac8705199fed5e5925
          name: 'System performance'
          pages:
            - widgets:
                - type: graph
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'Unifi by SNMP'
                        name: 'Linux: System load'
                    - type: STRING
                      name: reference
                      value: AAAAA
                - type: graph
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'Unifi by SNMP'
                        name: 'Linux: Memory usage'
                    - type: STRING
                      name: reference
                      value: AAAAC
                - type: graphprototype
                  'y': '10'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '3'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Unifi by SNMP'
                        name: 'FS [{#FSNAME}]: Space utilization chart (relative to total)'
                    - type: STRING
                      name: reference
                      value: AAAEA
                - type: graphprototype
                  'y': '15'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Unifi by SNMP'
                        name: '{#DEVNAME}: Disk read/write rates'
                    - type: STRING
                      name: reference
                      value: AAAAF
                - type: graphprototype
                  'y': '20'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: ITEM_PROTOTYPE
                      name: itemid.0
                      value:
                        host: 'Unifi by SNMP'
                        key: 'vfs.dev.util[diskIOLA1.{#SNMPINDEX}]'
                    - type: STRING
                      name: reference
                      value: AAAAG
                    - type: INTEGER
                      name: source_type
                      value: '3'
                - type: graphprototype
                  'y': '25'
                  width: '72'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Unifi by SNMP'
                        name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
                    - type: STRING
                      name: reference
                      value: AAAAH
                - type: graphprototype
                  x: '36'
                  width: '36'
                  height: '5'
                  fields:
                    - type: INTEGER
                      name: columns
                      value: '1'
                    - type: GRAPH_PROTOTYPE
                      name: graphid.0
                      value:
                        host: 'Unifi by SNMP'
                        name: 'Linux: CPU usage{#SINGLETON}'
                    - type: STRING
                      name: reference
                      value: AAAAB
                - type: graph
                  x: '36'
                  'y': '5'
                  width: '36'
                  height: '5'
                  fields:
                    - type: GRAPH
                      name: graphid.0
                      value:
                        host: 'Unifi by SNMP'
                        name: 'Linux: Swap usage'
                    - type: STRING
                      name: reference
                      value: AAAAD
      valuemaps:
        - uuid: 38ad0701eb94433283ed69c7c62349af
          name: 'EtherLike-MIB::dot3StatsDuplexStatus'
          mappings:
            - value: '1'
              newvalue: unknown
            - value: '2'
              newvalue: halfDuplex
            - value: '3'
              newvalue: fullDuplex
        - uuid: 6ef4fc6ba3b54c05ab155caa37c518fb
          name: 'IF-MIB::ifOperStatus'
          mappings:
            - value: '1'
              newvalue: up
            - value: '2'
              newvalue: down
            - value: '4'
              newvalue: unknown
            - value: '5'
              newvalue: dormant
            - value: '6'
              newvalue: notPresent
            - value: '7'
              newvalue: lowerLayerDown
        - uuid: 42935cb047aa415da0d35e5e704d7621
          name: 'IF-MIB::ifType'
          mappings:
            - value: '1'
              newvalue: other
            - value: '2'
              newvalue: regular1822
            - value: '3'
              newvalue: hdh1822
            - value: '4'
              newvalue: ddnX25
            - value: '5'
              newvalue: rfc877x25
            - value: '6'
              newvalue: ethernetCsmacd
            - value: '7'
              newvalue: iso88023Csmacd
            - value: '8'
              newvalue: iso88024TokenBus
            - value: '9'
              newvalue: iso88025TokenRing
            - value: '10'
              newvalue: iso88026Man
            - value: '11'
              newvalue: starLan
            - value: '12'
              newvalue: proteon10Mbit
            - value: '13'
              newvalue: proteon80Mbit
            - value: '14'
              newvalue: hyperchannel
            - value: '15'
              newvalue: fddi
            - value: '16'
              newvalue: lapb
            - value: '17'
              newvalue: sdlc
            - value: '18'
              newvalue: ds1
            - value: '19'
              newvalue: e1
            - value: '20'
              newvalue: basicISDN
            - value: '21'
              newvalue: primaryISDN
            - value: '22'
              newvalue: propPointToPointSerial
            - value: '23'
              newvalue: ppp
            - value: '24'
              newvalue: softwareLoopback
            - value: '25'
              newvalue: eon
            - value: '26'
              newvalue: ethernet3Mbit
            - value: '27'
              newvalue: nsip
            - value: '28'
              newvalue: slip
            - value: '29'
              newvalue: ultra
            - value: '30'
              newvalue: ds3
            - value: '31'
              newvalue: sip
            - value: '32'
              newvalue: frameRelay
            - value: '33'
              newvalue: rs232
            - value: '34'
              newvalue: para
            - value: '35'
              newvalue: arcnet
            - value: '36'
              newvalue: arcnetPlus
            - value: '37'
              newvalue: atm
            - value: '38'
              newvalue: miox25
            - value: '39'
              newvalue: sonet
            - value: '40'
              newvalue: x25ple
            - value: '41'
              newvalue: iso88022llc
            - value: '42'
              newvalue: localTalk
            - value: '43'
              newvalue: smdsDxi
            - value: '44'
              newvalue: frameRelayService
            - value: '45'
              newvalue: v35
            - value: '46'
              newvalue: hssi
            - value: '47'
              newvalue: hippi
            - value: '48'
              newvalue: modem
            - value: '49'
              newvalue: aal5
            - value: '50'
              newvalue: sonetPath
            - value: '51'
              newvalue: sonetVT
            - value: '52'
              newvalue: smdsIcip
            - value: '53'
              newvalue: propVirtual
            - value: '54'
              newvalue: propMultiplexor
            - value: '55'
              newvalue: ieee80212
            - value: '56'
              newvalue: fibreChannel
            - value: '57'
              newvalue: hippiInterface
            - value: '58'
              newvalue: frameRelayInterconnect
            - value: '59'
              newvalue: aflane8023
            - value: '60'
              newvalue: aflane8025
            - value: '61'
              newvalue: cctEmul
            - value: '62'
              newvalue: fastEther
            - value: '63'
              newvalue: isdn
            - value: '64'
              newvalue: v11
            - value: '65'
              newvalue: v36
            - value: '66'
              newvalue: g703at64k
            - value: '67'
              newvalue: g703at2mb
            - value: '68'
              newvalue: qllc
            - value: '69'
              newvalue: fastEtherFX
            - value: '70'
              newvalue: channel
            - value: '71'
              newvalue: ieee80211
            - value: '72'
              newvalue: ibm370parChan
            - value: '73'
              newvalue: escon
            - value: '74'
              newvalue: dlsw
            - value: '75'
              newvalue: isdns
            - value: '76'
              newvalue: isdnu
            - value: '77'
              newvalue: lapd
            - value: '78'
              newvalue: ipSwitch
            - value: '79'
              newvalue: rsrb
            - value: '80'
              newvalue: atmLogical
            - value: '81'
              newvalue: ds0
            - value: '82'
              newvalue: ds0Bundle
            - value: '83'
              newvalue: bsc
            - value: '84'
              newvalue: async
            - value: '85'
              newvalue: cnr
            - value: '86'
              newvalue: iso88025Dtr
            - value: '87'
              newvalue: eplrs
            - value: '88'
              newvalue: arap
            - value: '89'
              newvalue: propCnls
            - value: '90'
              newvalue: hostPad
            - value: '91'
              newvalue: termPad
            - value: '92'
              newvalue: frameRelayMPI
            - value: '93'
              newvalue: x213
            - value: '94'
              newvalue: adsl
            - value: '95'
              newvalue: radsl
            - value: '96'
              newvalue: sdsl
            - value: '97'
              newvalue: vdsl
            - value: '98'
              newvalue: iso88025CRFPInt
            - value: '99'
              newvalue: myrinet
            - value: '100'
              newvalue: voiceEM
            - value: '101'
              newvalue: voiceFXO
            - value: '102'
              newvalue: voiceFXS
            - value: '103'
              newvalue: voiceEncap
            - value: '104'
              newvalue: voiceOverIp
            - value: '105'
              newvalue: atmDxi
            - value: '106'
              newvalue: atmFuni
            - value: '107'
              newvalue: atmIma
            - value: '108'
              newvalue: pppMultilinkBundle
            - value: '109'
              newvalue: ipOverCdlc
            - value: '110'
              newvalue: ipOverClaw
            - value: '111'
              newvalue: stackToStack
            - value: '112'
              newvalue: virtualIpAddress
            - value: '113'
              newvalue: mpc
            - value: '114'
              newvalue: ipOverAtm
            - value: '115'
              newvalue: iso88025Fiber
            - value: '116'
              newvalue: tdlc
            - value: '117'
              newvalue: gigabitEthernet
            - value: '118'
              newvalue: hdlc
            - value: '119'
              newvalue: lapf
            - value: '120'
              newvalue: v37
            - value: '121'
              newvalue: x25mlp
            - value: '122'
              newvalue: x25huntGroup
            - value: '123'
              newvalue: trasnpHdlc
            - value: '124'
              newvalue: interleave
            - value: '125'
              newvalue: fast
            - value: '126'
              newvalue: ip
            - value: '127'
              newvalue: docsCableMaclayer
            - value: '128'
              newvalue: docsCableDownstream
            - value: '129'
              newvalue: docsCableUpstream
            - value: '130'
              newvalue: a12MppSwitch
            - value: '131'
              newvalue: tunnel
            - value: '132'
              newvalue: coffee
            - value: '133'
              newvalue: ces
            - value: '134'
              newvalue: atmSubInterface
            - value: '135'
              newvalue: l2vlan
            - value: '136'
              newvalue: l3ipvlan
            - value: '137'
              newvalue: l3ipxvlan
            - value: '138'
              newvalue: digitalPowerline
            - value: '139'
              newvalue: mediaMailOverIp
            - value: '140'
              newvalue: dtm
            - value: '141'
              newvalue: dcn
            - value: '142'
              newvalue: ipForward
            - value: '143'
              newvalue: msdsl
            - value: '144'
              newvalue: ieee1394
            - value: '145'
              newvalue: if-gsn
            - value: '146'
              newvalue: dvbRccMacLayer
            - value: '147'
              newvalue: dvbRccDownstream
            - value: '148'
              newvalue: dvbRccUpstream
            - value: '149'
              newvalue: atmVirtual
            - value: '150'
              newvalue: mplsTunnel
            - value: '151'
              newvalue: srp
            - value: '152'
              newvalue: voiceOverAtm
            - value: '153'
              newvalue: voiceOverFrameRelay
            - value: '154'
              newvalue: idsl
            - value: '155'
              newvalue: compositeLink
            - value: '156'
              newvalue: ss7SigLink
            - value: '157'
              newvalue: propWirelessP2P
            - value: '158'
              newvalue: frForward
            - value: '159'
              newvalue: rfc1483
            - value: '160'
              newvalue: usb
            - value: '161'
              newvalue: ieee8023adLag
            - value: '162'
              newvalue: bgppolicyaccounting
            - value: '163'
              newvalue: frf16MfrBundle
            - value: '164'
              newvalue: h323Gatekeeper
            - value: '165'
              newvalue: h323Proxy
            - value: '166'
              newvalue: mpls
            - value: '167'
              newvalue: mfSigLink
            - value: '168'
              newvalue: hdsl2
            - value: '169'
              newvalue: shdsl
            - value: '170'
              newvalue: ds1FDL
            - value: '171'
              newvalue: pos
            - value: '172'
              newvalue: dvbAsiIn
            - value: '173'
              newvalue: dvbAsiOut
            - value: '174'
              newvalue: plc
            - value: '175'
              newvalue: nfas
            - value: '176'
              newvalue: tr008
            - value: '177'
              newvalue: gr303RDT
            - value: '178'
              newvalue: gr303IDT
            - value: '179'
              newvalue: isup
            - value: '180'
              newvalue: propDocsWirelessMaclayer
            - value: '181'
              newvalue: propDocsWirelessDownstream
            - value: '182'
              newvalue: propDocsWirelessUpstream
            - value: '183'
              newvalue: hiperlan2
            - value: '184'
              newvalue: propBWAp2Mp
            - value: '185'
              newvalue: sonetOverheadChannel
            - value: '186'
              newvalue: digitalWrapperOverheadChannel
            - value: '187'
              newvalue: aal2
            - value: '188'
              newvalue: radioMAC
            - value: '189'
              newvalue: atmRadio
            - value: '190'
              newvalue: imt
            - value: '191'
              newvalue: mvl
            - value: '192'
              newvalue: reachDSL
            - value: '193'
              newvalue: frDlciEndPt
            - value: '194'
              newvalue: atmVciEndPt
            - value: '195'
              newvalue: opticalChannel
            - value: '196'
              newvalue: opticalTransport
            - value: '197'
              newvalue: propAtm
            - value: '198'
              newvalue: voiceOverCable
            - value: '199'
              newvalue: infiniband
            - value: '200'
              newvalue: teLink
            - value: '201'
              newvalue: q2931
            - value: '202'
              newvalue: virtualTg
            - value: '203'
              newvalue: sipTg
            - value: '204'
              newvalue: sipSig
            - value: '205'
              newvalue: docsCableUpstreamChannel
            - value: '206'
              newvalue: econet
            - value: '207'
              newvalue: pon155
            - value: '208'
              newvalue: pon622
            - value: '209'
              newvalue: bridge
            - value: '210'
              newvalue: linegroup
            - value: '211'
              newvalue: voiceEMFGD
            - value: '212'
              newvalue: voiceFGDEANA
            - value: '213'
              newvalue: voiceDID
            - value: '214'
              newvalue: mpegTransport
            - value: '215'
              newvalue: sixToFour
            - value: '216'
              newvalue: gtp
            - value: '217'
              newvalue: pdnEtherLoop1
            - value: '218'
              newvalue: pdnEtherLoop2
            - value: '219'
              newvalue: opticalChannelGroup
            - value: '220'
              newvalue: homepna
            - value: '221'
              newvalue: gfp
            - value: '222'
              newvalue: ciscoISLvlan
            - value: '223'
              newvalue: actelisMetaLOOP
            - value: '224'
              newvalue: fcipLink
            - value: '225'
              newvalue: rpr
            - value: '226'
              newvalue: qam
            - value: '227'
              newvalue: lmp
            - value: '228'
              newvalue: cblVectaStar
            - value: '229'
              newvalue: docsCableMCmtsDownstream
            - value: '230'
              newvalue: adsl2
            - value: '231'
              newvalue: macSecControlledIF
            - value: '232'
              newvalue: macSecUncontrolledIF
            - value: '233'
              newvalue: aviciOpticalEther
            - value: '234'
              newvalue: atmbond
            - value: '235'
              newvalue: voiceFGDOS
            - value: '236'
              newvalue: mocaVersion1
            - value: '237'
              newvalue: ieee80216WMAN
            - value: '238'
              newvalue: adsl2plus
            - value: '239'
              newvalue: dvbRcsMacLayer
            - value: '240'
              newvalue: dvbTdm
            - value: '241'
              newvalue: dvbRcsTdma
            - value: '242'
              newvalue: x86Laps
            - value: '243'
              newvalue: wwanPP
            - value: '244'
              newvalue: wwanPP2
            - value: '245'
              newvalue: voiceEBS
            - value: '246'
              newvalue: ifPwType
            - value: '247'
              newvalue: ilan
            - value: '248'
              newvalue: pip
            - value: '249'
              newvalue: aluELP
            - value: '250'
              newvalue: gpon
            - value: '251'
              newvalue: vdsl2
            - value: '252'
              newvalue: capwapDot11Profile
            - value: '253'
              newvalue: capwapDot11Bss
            - value: '254'
              newvalue: capwapWtpVirtualRadio
            - value: '255'
              newvalue: bits
            - value: '256'
              newvalue: docsCableUpstreamRfPort
            - value: '257'
              newvalue: cableDownstreamRfPort
            - value: '258'
              newvalue: vmwareVirtualNic
            - value: '259'
              newvalue: ieee802154
            - value: '260'
              newvalue: otnOdu
            - value: '261'
              newvalue: otnOtu
            - value: '262'
              newvalue: ifVfiType
            - value: '263'
              newvalue: g9981
            - value: '264'
              newvalue: g9982
            - value: '265'
              newvalue: g9983
            - value: '266'
              newvalue: aluEpon
            - value: '267'
              newvalue: aluEponOnu
            - value: '268'
              newvalue: aluEponPhysicalUni
            - value: '269'
              newvalue: aluEponLogicalLink
            - value: '270'
              newvalue: aluGponOnu
            - value: '271'
              newvalue: aluGponPhysicalUni
            - value: '272'
              newvalue: vmwareNicTeam
            - value: '277'
              newvalue: docsOfdmDownstream
            - value: '278'
              newvalue: docsOfdmaUpstream
            - value: '279'
              newvalue: gfast
            - value: '280'
              newvalue: sdci
            - value: '281'
              newvalue: xboxWireless
            - value: '282'
              newvalue: fastdsl
            - value: '283'
              newvalue: docsCableScte55d1FwdOob
            - value: '284'
              newvalue: docsCableScte55d1RetOob
            - value: '285'
              newvalue: docsCableScte55d2DsOob
            - value: '286'
              newvalue: docsCableScte55d2UsOob
            - value: '287'
              newvalue: docsCableNdf
            - value: '288'
              newvalue: docsCableNdr
            - value: '289'
              newvalue: ptm
            - value: '290'
              newvalue: ghn
        - uuid: 72662916c4144f289a63b6605bad1c83
          name: 'Service state'
          mappings:
            - value: '0'
              newvalue: Down
            - value: '1'
              newvalue: Up
        - uuid: 5da9dbc7fc434b2aa521424874177cc3
          name: zabbix.host.available
          mappings:
            - value: '0'
              newvalue: 'not available'
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: unknown
  triggers:
    - uuid: a791cb1f15744084bc633567e9d22655
      expression: 'max(/Unifi by SNMP/system.swap.pfree[snmp],5m)<{$SWAP.PFREE.MIN.WARN} and last(/Unifi by SNMP/system.swap.total[memTotalSwap.0])>0'
      name: 'Linux: High swap space usage'
      event_name: 'Linux: High swap space usage (less than {$SWAP.PFREE.MIN.WARN}% free)'
      opdata: 'Free: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}'
      priority: WARNING
      description: 'If there is no swap configured, this trigger is ignored.'
      dependencies:
        - name: 'Linux: High memory utilization'
          expression: 'min(/Unifi by SNMP/vm.memory.util[snmp],5m)>{$MEMORY.UTIL.MAX}'
        - name: 'Linux: Lack of available memory'
          expression: 'max(/Unifi by SNMP/vm.memory.available[snmp],5m)<{$MEMORY.AVAILABLE.MIN} and last(/Unifi by SNMP/vm.memory.total[memTotalReal.0])>0'
      tags:
        - tag: scope
          value: capacity
    - uuid: 87ee0652a4b94470a4e9c3c3a77328b5
      expression: '(last(/Unifi by SNMP/system.hw.uptime[hrSystemUptime.0])>0 and last(/Unifi by SNMP/system.hw.uptime[hrSystemUptime.0])<10m) or (last(/Unifi by SNMP/system.hw.uptime[hrSystemUptime.0])=0 and last(/Unifi by SNMP/system.net.uptime[sysUpTime.0])<10m)'
      name: 'Linux: Host has been restarted'
      event_name: 'Linux: {HOST.NAME} has been restarted (uptime < 10m)'
      priority: WARNING
      description: 'Uptime is less than 10 minutes.'
      manual_close: 'YES'
      dependencies:
        - name: 'Linux: No SNMP data collection'
          expression: 'max(/Unifi by SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
      tags:
        - tag: scope
          value: notice
    - uuid: a6f16c9fd81a422f8f37de9cfc80b6f4
      expression: 'max(/Unifi by SNMP/vm.memory.available[snmp],5m)<{$MEMORY.AVAILABLE.MIN} and last(/Unifi by SNMP/vm.memory.total[memTotalReal.0])>0'
      name: 'Linux: Lack of available memory'
      event_name: 'Linux: Lack of available memory (<{$MEMORY.AVAILABLE.MIN} of {ITEM.VALUE2})'
      opdata: 'Available: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}'
      priority: AVERAGE
      description: 'The system is running out of memory.'
      tags:
        - tag: scope
          value: capacity
        - tag: scope
          value: performance
    - uuid: 4ab161f099914574979cae943ca14360
      expression: |
        min(/Unifi by SNMP/system.cpu.load.avg1[laLoad.1],5m)/last(/Unifi by SNMP/system.cpu.num[snmp])>{$LOAD_AVG_PER_CPU.MAX.WARN}
        and last(/Unifi by SNMP/system.cpu.load.avg5[laLoad.2])>0
        and last(/Unifi by SNMP/system.cpu.load.avg15[laLoad.3])>0
      name: 'Linux: Load average is too high'
      event_name: 'Linux: Load average is too high (per CPU load over {$LOAD_AVG_PER_CPU.MAX.WARN} for 5m)'
      opdata: 'Load averages(1m 5m 15m): ({ITEM.LASTVALUE1} {ITEM.LASTVALUE3} {ITEM.LASTVALUE4}), # of CPUs: {ITEM.LASTVALUE2}'
      priority: AVERAGE
      description: 'The load average per CPU is too high. The system may be slow to respond.'
      tags:
        - tag: scope
          value: capacity
        - tag: scope
          value: performance
  graphs:
    - uuid: 35bd0f4dc0b949f3963ced21fc744050
      name: 'Linux: CPU jumps'
      graph_items:
        - color: 199C0D
          item:
            host: 'Unifi by SNMP'
            key: 'system.cpu.switches[ssRawContexts.0]'
        - sortorder: '1'
          color: F63100
          item:
            host: 'Unifi by SNMP'
            key: 'system.cpu.intr[ssRawInterrupts.0]'
    - uuid: 397bb0405ec7404e865db4fc2af7bf42
      name: 'Linux: Memory usage'
      ymin_type_1: FIXED
      graph_items:
        - drawtype: BOLD_LINE
          color: 199C0D
          item:
            host: 'Unifi by SNMP'
            key: 'vm.memory.total[memTotalReal.0]'
        - sortorder: '1'
          drawtype: GRADIENT_LINE
          color: F63100
          item:
            host: 'Unifi by SNMP'
            key: 'vm.memory.available[snmp]'
    - uuid: 2bddb12fd8714082af02e04f998963ce
      name: 'Linux: Memory utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        - drawtype: GRADIENT_LINE
          color: 199C0D
          item:
            host: 'Unifi by SNMP'
            key: 'vm.memory.util[snmp]'
    - uuid: 92dcd57fc97140e59ee7789047b75814
      name: 'Linux: Swap usage'
      graph_items:
        - color: 199C0D
          item:
            host: 'Unifi by SNMP'
            key: 'system.swap.free[memAvailSwap.0]'
        - sortorder: '1'
          color: F63100
          item:
            host: 'Unifi by SNMP'
            key: 'system.swap.total[memTotalSwap.0]'
    - uuid: 60aaf79c05f74258baabae90ef6cfd7b
      name: 'Linux: System load'
      ymin_type_1: FIXED
      graph_items:
        - color: 199C0D
          item:
            host: 'Unifi by SNMP'
            key: 'system.cpu.load.avg1[laLoad.1]'
        - sortorder: '1'
          color: F63100
          item:
            host: 'Unifi by SNMP'
            key: 'system.cpu.load.avg5[laLoad.2]'
        - sortorder: '2'
          color: 00611C
          item:
            host: 'Unifi by SNMP'
            key: 'system.cpu.load.avg15[laLoad.3]'
        - sortorder: '3'
          color: F7941D
          yaxisside: RIGHT
          item:
            host: 'Unifi by SNMP'
            key: 'system.cpu.num[snmp]'

